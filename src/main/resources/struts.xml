<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
	"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>

    <!-- Include json defaults -->
    <include file="json-default.xml" />

    <!-- Include module config files -->
    <include file="com/shunwang/starmedia/demo/action/*/*-struts.xml" />
    <include file="com/shunwang/starmedia/demo/action/*/*-validation.xml" />

    <!-- Configuration for the default package -->
    <package name="default" extends="json-default">

        <result-types>
            <result-type name="fm" default="true" class="org.apache.struts2.views.freemarker.FreemarkerResult" />
        </result-types>

        <interceptors>

            <!-- <interceptor name="authorizerInterceptor" class="net.zdsoft.demo.struts2.common.interceptor.AuthorizerInterceptor" 
                /> -->
            <interceptor name="exceptionCaughtInterceptor" class="com.shunwang.starmedia.starfish.interceptor.ExceptionCaughtInterceptor" />

            <!-- Basic stack -->
            <interceptor-stack name="basicStack">
                <interceptor-ref name="exception" />
                <interceptor-ref name="servletConfig" />
                <interceptor-ref name="prepare" />
                <interceptor-ref name="checkbox" />
                <interceptor-ref name="multiselect" />
                <interceptor-ref name="actionMappingParams" />
                <interceptor-ref name="params">
                    <param name="excludeParams">dojo\..*,^struts\..*,.*\\u0023.*</param>
                </interceptor-ref>
                <interceptor-ref name="conversionError" />
            </interceptor-stack>

            <interceptor-stack name="authStack">
                <interceptor-ref name="basicStack" />
                <interceptor-ref name="staticParams" />
                <!-- <interceptor-ref name="authorizerInterceptor" /> -->
                <interceptor-ref name="validation">
                    <param name="excludeMethods">list*, new*, view*, load*, remove*, del*</param>
                </interceptor-ref>
                <interceptor-ref name="workflow">
                    <param name="excludeMethods">list*, new*, view*, load*, remove*, del*</param>
                </interceptor-ref>
                <interceptor-ref name="exceptionCaughtInterceptor" />
            </interceptor-stack>

            <interceptor-stack name="defaultStack">
                <interceptor-ref name="basicStack" />
                <interceptor-ref name="staticParams" />
                <interceptor-ref name="exceptionCaughtInterceptor" />
            </interceptor-stack>

        </interceptors>

        <default-interceptor-ref name="defaultStack" />

        <global-results>
            <result name="exception">/error.ftl</result>
            <result name="login" type="redirect">/index.htm</result>
            <result name="input">
                <param name="contentType">application/json</param>
                <param name="location">/jsonInput.ftl</param>
            </result>
            <result name="jsonRefresh">
                <param name="contentType">application/json</param>
                <param name="location">/jsonRefresh.ftl</param>
            </result>
            <result name="jsonException">
                <param name="contentType">application/json</param>
                <param name="location">/jsonError.ftl</param>
            </result>
        </global-results>

        <global-exception-mappings>
            <exception-mapping exception="java.lang.Exception" result="exception" />
            <exception-mapping exception="org.apache.struts2.json.JSONException" result="jsonException" />
        </global-exception-mappings>

    </package>

</struts>
